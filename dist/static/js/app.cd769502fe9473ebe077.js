webpackJsonp([2,0],{0:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var n=o(16),a=r(n),s=o(23),u=r(s),l=o(99),i=r(l),c=o(87),d=r(c),f=o(88),p=r(f),v=o(89),m=r(v),_=o(92),g=r(_),h=o(91),w=r(h),b=o(51),S=r(b);u.default.use(i.default);var x=[{path:"/",component:p.default,meta:{auth:!1}},{path:"/login",component:m.default},{path:"/reg",component:g.default,meta:{auth:!1}},{path:"/person",component:w.default},{path:"*",component:p.default}],R=new i.default({mode:"history",saveScrollPosition:!0,routes:x});R.beforeEach(function(e,t,o){var r=e.meta,n=e.path,a=r.auth,s=void 0===a||a,u=Boolean(S.default.state.login.token);return s&&!u&&"/login"!==n?o({path:"/login"}):!u||"/login"!=n&&"/reg"!=n?void o():o({path:"/person"})});new u.default((0,a.default)({el:"#app",router:R,store:S.default},d.default))},15:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.USER_SIGNIN="USER_SIGNIN",t.USER_SIGNOUT="USER_SIGNOUT",t.USER_REG="USER_REG"},43:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(90),a=r(n);t.default={components:{navbar:a.default}}},44:function(e,t){"use strict"},45:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(5);t.default={data:function(){return{user:{name:"",password:""}}},computed:{},methods:{}}},46:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(16),a=r(n),s=o(5);t.default={computed:(0,a.default)({},(0,s.mapGetters)({}),(0,s.mapActions)({}),{user:function(){}}),methods:{logout:function(){this.$store.dispatch("UserLogout")}}}},47:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(5);t.default={data:function(){return{user:{name:"",password:"",password_r:""}}},computed:{},methods:{}}},48:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(24),a=r(n),s=o(25),u=r(s),l=o(86),i=r(l);a.default.use(i.default,u.default);var c=u.default.create();localStorage.getItem("user")&&(c.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("user").replace(/(^\")|(\"$)/g,"")),t.default={localLogin:function(e){return a.default.axios.post("/api/login",e)},localLogout:function(e){return c.post("/api/logout",e)},localReg:function(e){return a.default.axios.post("/api/reg",e)}}},49:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserReg=t.UserLogout=t.UserLogin=void 0;var n=o(48),a=r(n),s=o(15);t.UserLogin=function(e,t){var o=e.commit;a.default.localLogin(t).then(function(e){1==e.data.type?(o(s.USER_SIGNIN,e.data.token),window.location="/person"):window.location="/login"}).catch(function(e){console.log(e)})},t.UserLogout=function(e,t){var o=e.commit;a.default.localLogout(t).then(function(e){o(s.USER_SIGNOUT),window.location="/login"}).catch(function(e){console.log(e)})},t.UserReg=function(e,t){var o=e.commit;a.default.localReg(t).then(function(e){1==e.data.type&&(o(s.USER_REG,e.data.token),window.location="/person")}).catch(function(e){console.log(e)})}},50:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UserInfo=function(e){return e.login.token}},51:function(e,t,o){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(23),s=n(a),u=o(5),l=n(u),i=o(49),c=r(i),d=o(50),f=r(d),p=o(52),v=n(p);s.default.use(l.default);var m=!1;t.default=new l.default.Store({actions:c,getters:f,modules:{login:v.default},strict:m})},52:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n,a=o(56),s=r(a),u=o(53),l=r(u),i=o(15),c=function(){var e=localStorage.getItem("user");if(!e)return!1;var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3?JSON.parse(localStorage.getItem("user")):void 0},d={token:c()||null},f=(n={},(0,s.default)(n,i.USER_SIGNIN,function(e,t){localStorage.setItem("user",(0,l.default)(t)),e.token=t}),(0,s.default)(n,i.USER_SIGNOUT,function(e){localStorage.removeItem("user"),e.token=null}),(0,s.default)(n,i.USER_REG,function(e,t){localStorage.setItem("user",(0,l.default)(t)),e.token=t}),n);t.default={state:d,mutations:f}},87:function(e,t,o){var r=o(2)(o(43),o(93),null,null);e.exports=r.exports},88:function(e,t,o){var r=o(2)(o(44),o(97),null,null);e.exports=r.exports},89:function(e,t,o){var r=o(2)(o(45),o(95),null,null);e.exports=r.exports},90:function(e,t,o){var r=o(2)(o(46),o(98),null,null);e.exports=r.exports},91:function(e,t,o){var r=o(2)(null,o(94),null,null);e.exports=r.exports},92:function(e,t,o){var r=o(2)(o(47),o(96),null,null);e.exports=r.exports},93:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("navbar"),e._v(" "),o("router-view")],1)},staticRenderFns:[]}},94:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e._v("\n  个人页\n")])},staticRenderFns:[]}},95:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("h1",{staticClass:"margin-bottom-15"},[e._v("登录")]),e._v(" "),o("form",{attrs:{role:"form",method:"post"},on:{submit:function(t){t.preventDefault(),e.sub()}}},[o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],attrs:{type:"text",id:"username",placeholder:"用户名"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||(e.user.name=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],attrs:{type:"password",id:"password",placeholder:"密码"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||(e.user.password=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"form-group"},[o("input",{staticClass:"btn btn-info",attrs:{type:"submit",value:"登录"}}),e._v(" "),o("router-link",{staticClass:"btn btn-default",attrs:{to:"/"}},[e._v("返回")])],1)])])},staticRenderFns:[]}},96:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("h1",{staticClass:"margin-bottom-15"},[e._v("注册")]),e._v(" "),o("form",{attrs:{role:"form",method:"post"},on:{submit:function(t){t.preventDefault(),e.reg()}}},[o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],attrs:{type:"text",id:"username",placeholder:"用户名"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||(e.user.name=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],attrs:{type:"password",id:"password",placeholder:"密码"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||(e.user.password=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password_r,expression:"user.password_r"}],attrs:{type:"password",id:"password_r",placeholder:"再次输入密码"},domProps:{value:e.user.password_r},on:{input:function(t){t.target.composing||(e.user.password_r=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"form-group"},[o("input",{staticClass:"btn btn-info",attrs:{type:"submit",value:"提交"}}),e._v(" "),o("router-link",{staticClass:"btn btn-default",attrs:{to:"/"}},[e._v("返回")])],1)])])},staticRenderFns:[]}},97:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;e._self._c||t;return e._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e._v("\n\n\t首页"),o("br")])}]}},98:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("router-link",{attrs:{to:"/"}},[e._v("首页")]),e._v(" "),o("router-link",{attrs:{to:"/person"}},[e._v("用户中心")]),e._v(" "),e.user?e._e():o("router-link",{attrs:{to:"/login"}},[e._v("登录")]),e._v(" "),e.user?o("a",{attrs:{href:"javascript:void(0)"},on:{click:e.logout}},[e._v("退出")]):o("router-link",{attrs:{to:"/reg"}},[e._v("注册")])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=app.cd769502fe9473ebe077.js.map